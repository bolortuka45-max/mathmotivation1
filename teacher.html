<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8">
<title>–ë–∞–≥—à–∏–π–Ω –°–∞–º–±–∞—Ä</title>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-database.js";

const firebaseConfig = { /* —Ç–∞–Ω—ã Firebase config */ };
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

window.attendanceData = {};
window.scoresData = {};

// –ë–∞–≥—à–∏–π–Ω login –∫–æ–¥
const TEACHER_CODE = "1234"; // —Ç–∞ ”©”©—Ä –∫–æ–¥ —Ç–æ—Ö–∏—Ä—É—É–ª–∂ –±–æ–ª–Ω–æ

function teacherLogin() {
  const code = prompt("–ë–∞–≥—à–∏–π–Ω –∫–æ–¥ –æ—Ä—É—É–ª–Ω–∞ —É—É:");
  if(code !== TEACHER_CODE) return alert("–ë—É—Ä—É—É –∫–æ–¥!");
  document.getElementById('loginDiv').style.display='none';
  document.getElementById('dashboardDiv').style.display='block';
  startRealtime();
}

function startRealtime() {
  onValue(ref(db,'attendanceData'), snapshot => {
    window.attendanceData = snapshot.val() || {};
    updateDashboard();
  });
  onValue(ref(db,'scoresData'), snapshot => {
    window.scoresData = snapshot.val() || {};
    updateDashboard();
  });
}

// –°—É—Ä–∞–≥—á–¥—ã–Ω –∂–∞–≥—Å–∞–∞–ª—Ç
const studentsData = [
  { "name": "–•.–ê–º–∞—Ä–±–∞—è—Å–≥–∞–ª–∞–Ω", "code": "1011" },
  { "name": "–¢.–ë–∞—Ä—Ö–∞—Å–±–∞—è—Ä", "code": "2319" },
  { "name": "–ì.–ú–∏—á–∏–¥–º–∞–∞", "code": "2205" }
];

function getStudentStatus(isPresent, score){
  if(!isPresent) return 'üî¥ –•–∏—á—ç—ç–ª–¥ –æ—Ä–æ–æ–≥“Ø–π';
  if(score>=80) return 'üü¢ –ú–∞—à —Å–∞–π–Ω';
  if(score>=60) return 'üü° –°–∞–π–Ω';
  return 'üî¥ –ê–Ω—Ö–∞–∞—Ä–∞–ª —Ö—ç—Ä—ç–≥—Ç—ç–π';
}

function updateDashboard() {
  const tbody = document.getElementById('studentTableBody');
  tbody.innerHTML='';
  studentsData.forEach(student => {
    const isPresent = !!window.attendanceData[student.code];
    const loginTime = window.attendanceData[student.code] || '-';
    const score = window.scoresData[student.code] || 0;

    let scoreClass = 'score-low';
    if(score>=80) scoreClass='score-high';
    else if(score>=60) scoreClass='score-medium';

    const row = document.createElement('tr');
    row.innerHTML=`
      <td>${student.name}</td>
      <td>${student.code}</td>
      <td>${isPresent?'‚úÖ –ò—Ä—Å—ç–Ω':'‚ùå –ò—Ä—ç—ç–≥“Ø–π'}</td>
      <td>${loginTime}</td>
      <td class="${scoreClass}">${score}%</td>
      <td>${getStudentStatus(isPresent,score)}</td>
    `;
    tbody.appendChild(row);
  });
}

window.teacherLogin = teacherLogin;
window.updateDashboard = updateDashboard;
</script>

<style>
body{font-family:Arial;margin:20px;background:#f4f4f4;}
.container{max-width:1200px;margin:auto;background:white;padding:20px;border-radius:10px;}
.header{background:#4CAF50;color:white;padding:15px;border-radius:8px;text-align:center;margin-bottom:20px;}
table{width:100%;border-collapse:collapse;}
th,td{border:1px solid #ddd;padding:8px;text-align:left;}
th{background:#f8f9fa;}
.score-high{color:#27ae60;font-weight:bold;}
.score-medium{color:#f39c12;}
.score-low{color:#e74c3c;}
</style>
</head>
<body>
<div class="container">
  <div id="loginDiv">
    <h2>–ë–∞–≥—à–∏–π–Ω –Ω—ç–≤—Ç—Ä—ç–ª—Ç</h2>
    <button onclick="teacherLogin()">–ù—ç–≤—Ç—Ä—ç—Ö</button>
  </div>

  <div id="dashboardDiv" style="display:none;">
    <div class="header"><h1>üìä –ë–∞–≥—à–∏–π–Ω –°–∞–º–±–∞—Ä</h1></div>
    <table>
      <thead>
        <tr>
          <th>–°—É—Ä–∞–≥—á–∏–π–Ω –Ω—ç—Ä</th>
          <th>–ö–æ–¥</th>
          <th>–ò—Ä—Ü</th>
          <th>–ù—ç–≤—Ç—ç—Ä—Å—ç–Ω —Ü–∞–≥</th>
          <th>–ë–∞—Ç–∞—Ç–≥–∞–ª—ã–Ω –æ–Ω–æ–æ</th>
          <th>–¢”©–ª”©–≤</th>
        </tr>
      </thead>
      <tbody id="studentTableBody"></tbody>
    </table>
  </div>
</div>
</body>
</html>
